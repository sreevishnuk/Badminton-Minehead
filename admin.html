<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="admin-bg">

  <!-- âœ… SECURITY GUARD: Check authentication state immediately -->
  <script type="module">
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

    // Initialize Firebase Auth
    const auth = getAuth();

    // Listen for auth state changes
    onAuthStateChanged(auth, (user) => {
      if (!user) {
        // Redirect to login page if not authenticated
        window.location.href = 'adminlogin.html';
      }
      // If user is logged in, allow the page to load normally
    });
  </script>

  <nav class="admin-nav">
    <img src="badmintonlogo.png" alt="Badminton Logo" class="logo-sm" />
    <span class="admin-title">Admin Dashboard</span>
    <button class="btn-secondary" onclick="logoutAdmin()">Logout</button>
  </nav>

  <div class="admin-container">
    <section>
      <button class="btn-primary" onclick="toggleRegistration()">Enable/Disable Registration</button>
      <button class="btn-accent" onclick="generateFixtures()">Generate Fixtures</button>
    </section>

    <section>
      <h2>Player Control</h2>
      <div id="players-list">Loading players...</div>
    </section>

    <section>
      <h2>Manage Fixtures</h2>
      <div id="edit-fixtures">Loading fixtures...</div>
    </section>

    <section>
      <h2>Fixtures & Results</h2>
      <div id="enter-scores">Loading score entry...</div>
    </section>
  </div>

  <script src="script.js" type="module"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      if (typeof loadPlayers === 'function') loadPlayers();
      if (typeof loadFixturesAdmin === 'function') loadFixturesAdmin();
    });
  </script>
</body>
</html>
