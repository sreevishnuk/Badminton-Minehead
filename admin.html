<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard</title>
  <link rel="stylesheet" href="styles.css">
</head>
<body class="admin-bg">

  <!-- ✅ SECURITY CHECK: Redirect to login if not authenticated -->
  <script type="module">
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";

    // Initialize Firebase Auth
    // We assume your script.js has already initialized the app.
    // If not, you can initialize it here, but since script.js is loaded below, we rely on it.
    const auth = getAuth();

    onAuthStateChanged(auth, (user) => {
      if (!user) {
        // User is not signed in. Redirect to login page.
        window.location.href = 'adminlogin.html';
      }
      // If user is signed in, do nothing. Let the page load normally.
    });
  </script>

  <nav class="admin-nav">
    <img src="badmintonlogo.png" alt="Badminton Logo" class="logo-sm" />
    <span class="admin-title">Admin Dashboard</span>
    <button class="btn-secondary" onclick="logoutAdmin()">Logout</button>
  </nav>

  <div class="admin-container">
    <section>
      <button class="btn-primary" onclick="toggleRegistration()">Enable/Disable Registration</button>
      <button class="btn-accent" onclick="generateFixtures()">Generate Fixtures</button>
    </section>

    <section>
      <h2>Player Control</h2>
      <div id="players-list">Loading players...</div>
    </section>

    <section>
      <h2>Manage Fixtures</h2>
      <div id="edit-fixtures">Loading fixtures...</div>
    </section>

    <section>
      <h2>Fixtures & Results</h2> <!-- ✅ Fixed typo -->
      <div id="enter-scores">Loading score entry...</div>
    </section>
  </div>

  <script src="script.js" type="module"></script>
  <script>
    // Optional: Add loading indicators if script.js is slow to load
    document.addEventListener('DOMContentLoaded', () => {
      // script.js will replace these, but this is a nice fallback
      if (typeof loadPlayers === 'function') loadPlayers();
      if (typeof loadFixturesAdmin === 'function') loadFixturesAdmin();
    });
  </script>
</body>
</html>
